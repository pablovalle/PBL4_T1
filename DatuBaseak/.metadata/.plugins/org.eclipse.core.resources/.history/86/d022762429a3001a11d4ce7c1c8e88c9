package Objetos;

import DAO.DAOUsuario;
import Excepciones.ExcepcionCampos;
import Excepciones.ExcepcionPassword;
import Excepciones.ExcepcionUsername;

public class Check {

	public static void check(String password1, String password2, String username, String nombre, String apellidos,
			String email)throws ExcepcionPassword,ExcepcionUsername, ExcepcionCampos {
		validarCamposVacios(nombre, apellidos, username, email);
		validarUsername(username);
		validarContraseña(password1, password2);
		
	}

	private static void validarContraseña(String password1, String password2) throws ExcepcionPassword {
		if (!password1.equals(password2)) {
			throw new ExcepcionPassword("¡Las contraseñas no coinciden!");
		}
		if (!validarContraseniaMayusMinus(password1) || !validarContraseniaNumeros(password1)
				|| password1.length() < 8) {
			throw new ExcepcionPassword("¡La contraseña no cumple con los requisitos mínimos!");
		}
		
	}

	private static boolean validarContraseniaMayusMinus(String contraseña) {
		boolean mayus = false;
		boolean minus = false;
		char[] pass = contraseña.toCharArray();
		for (int i = 0; i < pass.length; i++) {
			if (!mayus && Character.isUpperCase(pass[i])) {
				mayus = true;
			} else if (!minus && Character.isLowerCase(pass[i])) {
				minus = true;
			}
			if (minus && mayus)
				break;
		}

		return mayus && minus;
	}

	private static boolean validarContraseniaNumeros(String contraseña) {
		boolean num = false;
		char[] pass = contraseña.toCharArray();
		for (int i = 0; i < pass.length; i++) {
			if (Character.isDigit(pass[i])) {
				num = true;
				break;
			}
		}
		return num;
	}

	private static void validarUsername(String username) throws ExcepcionUsername {
		if (username.length() > 15) {
			throw new ExcepcionUsername("¡El nombre de usuario sobrepasa el máximo de caracteres permitidos!");
		}

		if (DAOUsuario.comprobarUsername(username)) {
			throw new ExcepcionUsername("¡Ese nombre de usuario ya existe!");
		}
		
	}

	private static void validarCamposVacios(String nombre, String apellidos, String username, String email) {
		
		
	}

}
